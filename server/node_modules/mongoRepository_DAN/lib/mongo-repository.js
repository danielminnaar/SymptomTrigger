var mongodb = require('mongodb');
var mongoClient = mongodb.MongoClient;


var MongoRepository = function (connectionString, collection) {
    var db = mongoClient.connect(connectionString, function (err, db) {

        this.add = function(value) {
            db.collection(collection).insert(value, function(err, result){
                db.close();
               
            });
        };
        
        this.find = function(query, callback) {
          db.collection(collection).find(query).toArray(function(err, docs) {
            db.close();
             callback(docs) ;
          });
        };


    });

};

//function openConnection() {
//    var database;
//    mongoClient.connect(mongoUrl, function (err, db) {
//        if (err) {
//            return null;
//        } else {
//            database = db;
//        }
//    });
//    console.log('db is ' + database);
//    return database;
//};

exports.Repository = MongoRepository;